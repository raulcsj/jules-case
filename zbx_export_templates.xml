<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>6.0</version>
    <date>2025-10-20T13:59:00Z</date>
    <groups>
        <group>
            <uuid>a571c0d144b14fd4a87a9d9b2aa9fcd6</uuid>
            <name>Templates/Applications</name>
        </group>
        <group>
            <uuid>846977d1dfed4968bc5f8bdb363285bc</uuid>
            <name>Templates/Operating systems</name>
        </group>
    </groups>
    <templates>
        <template>
            <uuid>d0571c5f2c204b7ab244843040288a35</uuid>
            <template>Acronis Cyber Protect Cloud by HTTP</template>
            <name>Acronis Cyber Protect Cloud by HTTP</name>
            <description>Requests Acronis Cyber Protect Cloud API access token and creates host prototype for MSP.

Template uses HTTP item to query Acronis Cyber Protect Cloud API client for authorization.

Read the template documentation prior to using this template.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback

Generated by official Zabbix template tool &quot;Templator&quot;</description>
            <groups>
                <group>
                    <name>Templates/Applications</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>bce642c2c6e743ccb618c96f6ca533da</uuid>
                    <name>Acronis CPC: Get access token</name>
                    <type>HTTP_AGENT</type>
                    <key>acronis.cpc.account_manager.get_token</key>
                    <delay>{$ACRONIS.CPC.AUTH.INTERVAL}</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <authtype>BASIC</authtype>
                    <username>{$ACRONIS.CPC.AUTH.CLIENT.ID}</username>
                    <password>{$ACRONIS.CPC.AUTH.SECRET}</password>
                    <description>Authorizes API user and receives access token.</description>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>value = JSON.parse(value);

var list = [];
list.push({ 'scope': value['scope'].split(':')[3], 'access_token': value['access_token'] });
return JSON.stringify(list);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>15s</timeout>
                    <url>{$ACRONIS.CPC.DATACENTER.URL}{$ACRONIS.CPC.PATH.ACCOUNT.MANAGEMENT}/idp/token</url>
                    <posts>grant_type=client_credentials</posts>
                    <status_codes/>
                    <http_proxy>{$ACRONIS.CPC.HTTP.PROXY}</http_proxy>
                    <headers>
                        <header>
                            <name>Content-Type</name>
                            <value>application/x-www-form-urlencoded</value>
                        </header>
                        <header>
                            <name>X-Application-Secret</name>
                            <value>5619386d-de56-49ec-8508-f5c399d3b9bd</value>
                        </header>
                    </headers>
                    <request_method>POST</request_method>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>authorization</value>
                        </tag>
                    </tags>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>d2c30d84c5f44734bc2f0ef38e99a959</uuid>
                    <name>Acronis CPC: MSP Discovery</name>
                    <type>DEPENDENT</type>
                    <key>acronis.cpc.lld.msp_discovery</key>
                    <delay>0</delay>
                    <description>Discovers MSP and creates host prototype based on that.</description>
                    <host_prototypes>
                        <host_prototype>
                            <uuid>bbdc747270f64876bc701dd87c27dbbe</uuid>
                            <host>Acronis CPC MSP {#SCOPE}</host>
                            <name>Acronis CPC MSP {#SCOPE}</name>
                            <group_links>
                                <group_link>
                                    <group>
                                        <name>Templates/Applications</name>
                                    </group>
                                </group_link>
                            </group_links>
                            <templates>
                                <template>
                                    <name>Acronis Cyber Protect Cloud MSP by HTTP</name>
                                </template>
                            </templates>
                            <macros>
                                <macro>
                                    <macro>{$ACRONIS.CPC.ACCESS_TOKEN}</macro>
                                    <value>{#ACCESS_TOKEN}</value>
                                    <description>Acronis CPC API access token.</description>
                                </macro>
                                <macro>
                                    <macro>{$ACRONIS.CPC.MSP.TENANT.UUID}</macro>
                                    <value>{#SCOPE}</value>
                                    <description>UUID of API client tenant.</description>
                                </macro>
                            </macros>
                        </host_prototype>
                    </host_prototypes>
                    <master_item>
                        <key>acronis.cpc.account_manager.get_token</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#ACCESS_TOKEN}</lld_macro>
                            <path>$.access_token</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#SCOPE}</lld_macro>
                            <path>$.scope</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
            </discovery_rules>
            <tags>
                <tag>
                    <tag>class</tag>
                    <value>application</value>
                </tag>
                <tag>
                    <tag>target</tag>
                    <value>acronis</value>
                </tag>
                <tag>
                    <tag>target</tag>
                    <value>cyber-protect-cloud</value>
                </tag>
            </tags>
            <macros>
                <macro>
                    <macro>{$ACRONIS.CPC.AUTH.CLIENT.ID}</macro>
                    <description>Client ID for API user access.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.AUTH.INTERVAL}</macro>
                    <value>110m</value>
                    <description>API token regeneration interval, in minutes. By default, Acronis Cyber Protect Cloud tokens expire after 2 hours.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.AUTH.SECRET}</macro>
                    <type>SECRET_TEXT</type>
                    <description>Secret for API user access.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.DATACENTER.URL}</macro>
                    <description>Acronis Cyber Protect Cloud datacenter URL, e.g., https://eu2-cloud.acronis.com.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.HTTP.PROXY}</macro>
                    <description>Sets the HTTP proxy for the authorization item. Host prototypes will also use this value for HTTP proxy. If this parameter is empty, then no proxy is used.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.PATH.ACCOUNT.MANAGEMENT}</macro>
                    <value>/api/2</value>
                    <description>Sub-path for the Account Management API.</description>
                </macro>
            </macros>
        </template>
        <template>
            <uuid>bf3107deff3a4aabab1e1c0ee71a3281</uuid>
            <template>Acronis Cyber Protect Cloud MSP by HTTP</template>
            <name>Acronis Cyber Protect Cloud MSP by HTTP</name>
            <description>Discovers and monitors alerts, clients, devices using HTTP agent items.

This template receives API token and datacenter URL from parent host, therefore no additional configuration is necessary.

Read the template documentation prior to using this template.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback

Generated by official Zabbix template tool &quot;Templator&quot;</description>
            <groups>
                <group>
                    <name>Templates/Applications</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>dba9a02767be47819f7012f316723fff</uuid>
                    <name>Acronis CPC: Get alerts</name>
                    <type>HTTP_AGENT</type>
                    <key>acronis.cpc.alerts.get</key>
                    <delay>5m</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Fetches all alerts.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.items</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>15s</timeout>
                    <url>{$ACRONIS.CPC.DATACENTER.URL}{$ACRONIS.CPC.PATH.ALERTS}/alerts</url>
                    <status_codes/>
                    <http_proxy>{$ACRONIS.CPC.HTTP.PROXY}</http_proxy>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                        <header>
                            <name>Authorization</name>
                            <value>Bearer {$ACRONIS.CPC.ACCESS_TOKEN}</value>
                        </header>
                        <header>
                            <name>X-Application-Secret</name>
                            <value>5619386d-de56-49ec-8508-f5c399d3b9bd</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>raw</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>483f9e040091476ba3857ae2957d83bf</uuid>
                    <name>Acronis CPC: Alerts with &quot;critical&quot; severity</name>
                    <type>DEPENDENT</type>
                    <key>acronis.cpc.alerts.severity.crit</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Gets count of alerts with &quot;critical&quot; severity.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$..[?(@.severity == 'critical')].length()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>acronis.cpc.alerts.get</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>alert</value>
                        </tag>
                        <tag>
                            <tag>component</tag>
                            <value>application</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>4fcefc1b66fe4c56b68cf5712aa727e5</uuid>
                    <name>Acronis CPC: Alerts with &quot;error&quot; severity</name>
                    <type>DEPENDENT</type>
                    <key>acronis.cpc.alerts.severity.err</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Gets count of alerts with &quot;error&quot; severity.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$..[?(@.severity == 'error')].length()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>acronis.cpc.alerts.get</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>alert</value>
                        </tag>
                        <tag>
                            <tag>component</tag>
                            <value>application</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>06003951452f4687bd0f1c0a395e7a77</uuid>
                    <name>Acronis CPC: Alerts with &quot;information&quot; severity</name>
                    <type>DEPENDENT</type>
                    <key>acronis.cpc.alerts.severity.info</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Gets count of alerts with &quot;information&quot; severity.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$..[?(@.severity == 'information')].length()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>acronis.cpc.alerts.get</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>alert</value>
                        </tag>
                        <tag>
                            <tag>component</tag>
                            <value>application</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ca3a1c7649874dfdaf191c7063022498</uuid>
                    <name>Acronis CPC: Alerts with &quot;ok&quot; severity</name>
                    <type>DEPENDENT</type>
                    <key>acronis.cpc.alerts.severity.ok</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Gets count of alerts with &quot;ok&quot; severity.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$..[?(@.severity == 'ok')].length()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>acronis.cpc.alerts.get</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>alert</value>
                        </tag>
                        <tag>
                            <tag>component</tag>
                            <value>application</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a4516d8961b3426f859511e1614c4403</uuid>
                    <name>Acronis CPC: Alerts with &quot;warning&quot; severity</name>
                    <type>DEPENDENT</type>
                    <key>acronis.cpc.alerts.severity.warn</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Gets count of alerts with &quot;warning&quot; severity.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$..[?(@.severity == 'warning')].length()</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>acronis.cpc.alerts.get</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>alert</value>
                        </tag>
                        <tag>
                            <tag>component</tag>
                            <value>application</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>77f25dbbd477458a88f1850701dccc69</uuid>
                    <name>Acronis CPC: Get customers</name>
                    <type>HTTP_AGENT</type>
                    <key>acronis.cpc.customers.get</key>
                    <delay>5m</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Fetches all customers.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.items</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>15s</timeout>
                    <url>{$ACRONIS.CPC.DATACENTER.URL}{$ACRONIS.CPC.PATH.ACCOUNT.MANAGEMENT}/tenants</url>
                    <query_fields>
                        <query_field>
                            <name>subtree_root_id</name>
                            <value>{$ACRONIS.CPC.MSP.TENANT.UUID}</value>
                        </query_field>
                    </query_fields>
                    <status_codes/>
                    <http_proxy>{$ACRONIS.CPC.HTTP.PROXY}</http_proxy>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                        <header>
                            <name>Authorization</name>
                            <value>Bearer {$ACRONIS.CPC.ACCESS_TOKEN}</value>
                        </header>
                        <header>
                            <name>X-Application-Secret</name>
                            <value>5619386d-de56-49ec-8508-f5c399d3b9bd</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>raw</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>81b3d23d30964b88aeb3a0911ba0e487</uuid>
                    <name>Acronis CPC: Get devices</name>
                    <type>HTTP_AGENT</type>
                    <key>acronis.cpc.devices.get</key>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Fetches all devices.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.items</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <timeout>15s</timeout>
                    <url>{$ACRONIS.CPC.DATACENTER.URL}{$ACRONIS.CPC.PATH.RESOURCE.MANAGEMENT}/resources</url>
                    <query_fields>
                        <query_field>
                            <name>type</name>
                            <value>{$ACRONIS.CPC.DEVICE.RESOURCE.TYPE}</value>
                        </query_field>
                    </query_fields>
                    <status_codes/>
                    <http_proxy>{$ACRONIS.CPC.HTTP.PROXY}</http_proxy>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                        <header>
                            <name>Authorization</name>
                            <value>Bearer {$ACRONIS.CPC.ACCESS_TOKEN}</value>
                        </header>
                        <header>
                            <name>X-Application-Secret</name>
                            <value>5619386d-de56-49ec-8508-f5c399d3b9bd</value>
                        </header>
                    </headers>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>raw</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3697d34ebbb74b90aa7318321ecc27e5</uuid>
                    <name>Acronis CPC: Register integration</name>
                    <type>SCRIPT</type>
                    <key>acronis.cpc.register.integration</key>
                    <delay>24h</delay>
                    <history>0</history>
                    <trends>0</trends>
                    <params>
const request_path = '/api/integration_management/v2/status';
const app_id = '5619386d-de56-49ec-8508-f5c399d3b9bd';

function checkParams(params) {
	['api_url', 'api_token', 'tenant_uuid'].forEach(function (field) {
		if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
			throw 'Required param is not set: ' + field + '.';
		}
	});
	return params;
}

function getHttpData(url, register, params, api_token, tenant_uuid) {
	const request = new HttpRequest();

	request.addHeader('Content-Type: application/json');
	request.addHeader('Authorization: Bearer ' + api_token);
	request.addHeader('X-Application-Secret: ' + app_id);

	if (params['http_proxy']) {
		request.setProxy(params['http_proxy']);
		Zabbix.log(4, '[ ACRONIS CYBER PROTECT CLOUD API ] Using http proxy: ' + params['http_proxy']);
	}

	if (!register) {
		const response = request.get(url + '?tenantID=' + encodeURIComponent(tenant_uuid));
		Zabbix.log(4, '[ ACRONIS CYBER PROTECT CLOUD API ] [ ' + url + ' ] Received response with status code ' + request.getStatus() + ': ' + response);

		if (request.getStatus() !== 200) {
			if (typeof (response.error &amp;&amp; response.error.message) !== 'undefined') {
				throw response.error.message;
			} else {
				throw 'Failed to receive data: invalid response status code. Check debug log for more information.';
			}
		}

		return response;

	} else {

		const request_body = {
			&quot;application_id&quot;: app_id,
			&quot;module&quot;: {
				&quot;name&quot;: &quot;Zabbix integration with Acronis Cyber Protect Cloud&quot;,
				&quot;version&quot;: &quot;1.0.0&quot;
			},
			&quot;vendor_system&quot;: {
				&quot;name&quot;: &quot;Product integrated with Acronis&quot;,
				&quot;version&quot;: &quot;23.07&quot;
			},
			&quot;events&quot;: [
				{
					&quot;category&quot;: &quot;activation&quot;,
					&quot;action&quot;: &quot;activated integration&quot;,
					&quot;activation_event&quot;: true
				}
			]
		};

		const response = request.post(url + '?tenantID=' + encodeURIComponent(tenant_uuid), JSON.stringify(request_body));
		Zabbix.log(4, '[ ACRONIS CYBER PROTECT CLOUD API ] [ ' + url + ' ] Received response with status code ' + request.getStatus() + ': ' + response);

		if (request.getStatus() !== 204) {
			if (typeof (response.error &amp;&amp; response.error.message) !== 'undefined') {
				throw response.error.message;
			} else {
				throw 'Failed to receive data: invalid response status code. Check debug log for more information.';
			}
		}

		return 1;
	}
}

function parseGetStatusData(http_response) {
	const data = JSON.parse(http_response);
	if (data['items']) {
		data['items'].forEach(function (app) {
			if (app['application_id'] &amp;&amp; app['application_id'] === app_id) {
				return app['active'];
			}
		});
		return false;
	} else {
		throw 'Unexpected data structure in HTTP response.';
	}
}

const params = checkParams(JSON.parse(value)),
	url = params.api_url,
	api_token = params.api_token,
	tenant_uuid = params.tenant_uuid;

const current_activation_status = parseGetStatusData(getHttpData(url + request_path, false, params, api_token, tenant_uuid));

if (!current_activation_status) {
	return getHttpData(url + request_path, true, params, api_token, tenant_uuid);
} else {
	return 0;
}</params>
                    <description>Registers integration on Acronis services.</description>
                    <timeout>30s</timeout>
                    <parameters>
                        <parameter>
                            <name>api_token</name>
                            <value>{$ACRONIS.CPC.ACCESS_TOKEN}</value>
                        </parameter>
                        <parameter>
                            <name>api_url</name>
                            <value>{$ACRONIS.CPC.DATACENTER.URL}</value>
                        </parameter>
                        <parameter>
                            <name>tenant_uuid</name>
                            <value>{$ACRONIS.CPC.MSP.TENANT.UUID}</value>
                        </parameter>
                    </parameters>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>raw</value>
                        </tag>
                    </tags>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>ee0d74749b93459ca40e477b31b3aa21</uuid>
                    <name>Acronis CPC: Alerts discovery</name>
                    <type>DEPENDENT</type>
                    <key>acronis.cpc.alerts.discovery</key>
                    <delay>0</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#CATEGORY}</macro>
                                <value>{$ACRONIS.CPC.ALERT.DISCOVERY.CATEGORY.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#CATEGORY}</macro>
                                <value>{$ACRONIS.CPC.ALERT.DISCOVERY.CATEGORY.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#RESOURCE_NAME}</macro>
                                <value>{$ACRONIS.CPC.ALERT.DISCOVERY.RESOURCE.MATCHES}</value>
                                <formulaid>C</formulaid>
                            </condition>
                            <condition>
                                <macro>{#RESOURCE_NAME}</macro>
                                <value>{$ACRONIS.CPC.ALERT.DISCOVERY.RESOURCE.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>D</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SEVERITY}</macro>
                                <value>{$ACRONIS.CPC.ALERT.DISCOVERY.SEVERITY.MATCHES}</value>
                                <formulaid>E</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SEVERITY}</macro>
                                <value>{$ACRONIS.CPC.ALERT.DISCOVERY.SEVERITY.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>F</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>0</lifetime>
                    <description>Discovers alerts.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>b298e768dc0447b4b5c29c99a5852453</uuid>
                            <name>Alert [{#TYPE}]:[{#ALERT_ID}]: Alert severity</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.alert.severity[{#ALERT_ID}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Severity for the alert.</description>
                            <valuemap>
                                <name>Alert severity</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$[?(@.id == &quot;{#ALERT_ID}&quot;)].severity.first()</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Could not find alert severity</error_handler_params>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>const idx = [
	'ok',
	'warning',
	'error',
	'critical',
	'information'
].indexOf(value);
return idx !== -1 ? idx : 10;</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.alerts.get</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>category</tag>
                                    <value>{#CATEGORY}</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>alert</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#RESOURCE_NAME}</value>
                                </tag>
                                <tag>
                                    <tag>severity</tag>
                                    <value>{#SEVERITY}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>f72a128c289540869ceeb4eb8a32519b</uuid>
                                    <expression>last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.alert.severity[{#ALERT_ID}])=3</expression>
                                    <name>Alert [{#TYPE}]:[{#ALERT_ID}]: Alert has &quot;critical&quot; severity</name>
                                    <event_name>Alert [{#ALERT_ID}]: &quot;critical&quot; severity</event_name>
                                    <opdata>Alert type: {#TYPE}, Current status: {ITEM.LASTVALUE}</opdata>
                                    <priority>HIGH</priority>
                                    <description>Alert has &quot;critical&quot; severity.</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>notice</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>360fcc25d3fe442194ddea76db8157be</uuid>
                                    <expression>last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.alert.severity[{#ALERT_ID}])=2</expression>
                                    <name>Alert [{#TYPE}]:[{#ALERT_ID}]: Alert has &quot;error&quot; severity</name>
                                    <event_name>Alert [{#ALERT_ID}]: &quot;error&quot; severity</event_name>
                                    <opdata>Alert type: {#TYPE}, Current status: {ITEM.LASTVALUE}</opdata>
                                    <priority>AVERAGE</priority>
                                    <description>Alert has &quot;error&quot; severity.</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Alert [{#TYPE}]:[{#ALERT_ID}]: Alert has &quot;critical&quot; severity</name>
                                            <expression>last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.alert.severity[{#ALERT_ID}])=3</expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>notice</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>687b26d91e6e448d911663f190328fb4</uuid>
                                    <expression>last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.alert.severity[{#ALERT_ID}])=1</expression>
                                    <name>Alert [{#TYPE}]:[{#ALERT_ID}]: Alert has &quot;warning&quot; severity</name>
                                    <event_name>Alert [{#ALERT_ID}]: &quot;warning&quot; severity</event_name>
                                    <opdata>Alert type: {#TYPE}, Current status: {ITEM.LASTVALUE}</opdata>
                                    <priority>WARNING</priority>
                                    <description>Alert has &quot;warning&quot; severity.</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Alert [{#TYPE}]:[{#ALERT_ID}]: Alert has &quot;error&quot; severity</name>
                                            <expression>last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.alert.severity[{#ALERT_ID}])=2</expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>notice</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>acronis.cpc.alerts.get</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#ALERT_ID}</lld_macro>
                            <path>$.id</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#CATEGORY}</lld_macro>
                            <path>$.category</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#RESOURCE_NAME}</lld_macro>
                            <path>$.details.resourceName</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#SEVERITY}</lld_macro>
                            <path>$.severity</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#TYPE}</lld_macro>
                            <path>$.type</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>4211387734c642f88e236bd588940cc1</uuid>
                    <name>Acronis CPC: Customer discovery</name>
                    <type>DEPENDENT</type>
                    <key>acronis.cpc.customer.discovery</key>
                    <delay>0</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#KIND}</macro>
                                <value>{$ACRONIS.CPC.CUSTOMER.DISCOVERY.KIND.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#NAME}</macro>
                                <value>{$ACRONIS.CPC.CUSTOMER.DISCOVERY.NAME.MATCHES}</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#NAME}</macro>
                                <value>{$ACRONIS.CPC.CUSTOMER.DISCOVERY.NAME.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>C</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <description>Discovers customers.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>d61dc067880a4317886acd54d0df1da1</uuid>
                            <name>Customer [{#NAME}]: Enabled status</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.customer.status[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Enabled status for customer (true or false).</description>
                            <valuemap>
                                <name>True false</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$[?(@.name == &quot;{#NAME}&quot;)].enabled.first()</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Could not find customer status</error_handler_params>
                                </step>
                                <step>
                                    <type>BOOL_TO_DECIMAL</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.customers.get</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>customer</value>
                                </tag>
                                <tag>
                                    <tag>customer</tag>
                                    <value>{#NAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>acronis.cpc.customers.get</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#KIND}</lld_macro>
                            <path>$.kind</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NAME}</lld_macro>
                            <path>$.name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>67e399a0a6884589adc2618b181024e7</uuid>
                    <name>Acronis CPC: Device discovery</name>
                    <type>DEPENDENT</type>
                    <key>acronis.cpc.device.discovery</key>
                    <delay>0</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#TENANT_NAME}</macro>
                                <value>{$ACRONIS.CPC.DEVICE.DISCOVERY.TENANT.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#TENANT_NAME}</macro>
                                <value>{$ACRONIS.CPC.DEVICE.DISCOVERY.TENANT.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <description>Discovers devices.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>63f8280408c34e029085af75f15c0db3</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Agent enabled</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.agent.enabled[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Agent status (enabled or disabled) for the device.</description>
                            <valuemap>
                                <name>True false</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.context.attributes.[?(@.name == &quot;agent&quot;)].kvs.[?(@.key == &quot;enabled&quot;)].value.first()</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Could not parse agent status</error_handler_params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>7e33ba82ad90436c88beee8d32a3f29d</uuid>
                                    <expression>max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.agent.enabled[{#NAME}],3m) &lt; 1</expression>
                                    <name>Device [{#NAME}]:[{#ID}]: Agent disabled</name>
                                    <opdata>Current score: {ITEM.LASTVALUE}</opdata>
                                    <priority>INFO</priority>
                                    <description>Agent for this device is disabled for at least 3 minutes.</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>notice</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>e1eaefb0e0af4793abadb0b3ad20ff4b</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Agent online</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.agent.online[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Agent reachability for the device.</description>
                            <valuemap>
                                <name>True false</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.context.attributes.[?(@.name == &quot;agent&quot;)].kvs.[?(@.key == &quot;is_online&quot;)].value.first()</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Could not parse agent reachability status</error_handler_params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>7bc04c3526704b578e2b7561e6c97b6a</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Agent version</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.agent.version[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>Agent version for the device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.context.attributes.[?(@.name == &quot;agent&quot;)].kvs.[?(@.key == &quot;version&quot;)].value.first()</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Could not parse agent version</error_handler_params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>d8c3372e05f3480aaa499b143ab47e87</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Next machine backup run</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.backup.next[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>unixtime</units>
                            <description>Next scheduled machine backup run for device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.policies.[?(@.type == &quot;policy.backup.machine&quot;)].next_run.first()</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>return Math.floor(Date.parse(value) / 1000);</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>6a2c53a89d7748f89956464849d0b7de</uuid>
                                    <expression>last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.backup.next[{#NAME}]) &lt; (now() + {$ACRONIS.CPC.OFFSET.SCHEDULED.BACKUP})</expression>
                                    <name>Device [{#NAME}]:[{#ID}]: Scheduled machine backup failed to run</name>
                                    <opdata>Scheduled: {ITEM.LASTVALUE1}</opdata>
                                    <priority>WARNING</priority>
                                    <description>Scheduled machine backup failed to run.</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>notice</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>9fbbfa68438a406d82900d5c8801a756</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Previous successful machine backup run</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.backup.prev.ok[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>unixtime</units>
                            <description>Previous successful machine backup run for device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.policies.[?(@.type == &quot;policy.backup.machine&quot;)].last_success_run.first()</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>return Math.floor(Date.parse(value) / 1000);</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>cea527353e34488a92dc5d2c082f6710</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Previous machine backup run</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.backup.prev[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>unixtime</units>
                            <description>Previous machine backup run for device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.policies.[?(@.type == &quot;policy.backup.machine&quot;)].last_run.first()</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>return Math.floor(Date.parse(value) / 1000);</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>b45fb50f8caa40438eecfc4482d80fc2</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: CyberFit score</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.cyberfit[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <description>Acronis &quot;CyberFit&quot; score for the device. Value of &quot;-1&quot; is assigned if &quot;CyberFit&quot; could not be found for device.</description>
                            <valuemap>
                                <name>CyberFit score</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.context.attributes.[?(@.name == &quot;cyberfit&quot;)].details.[?(@.key == &quot;cyberfit_score_value&quot;)].value.first()</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>-1</error_handler_params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>0c7edd6256fc48c49316644faef8df0a</uuid>
                                    <expression>min(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.cyberfit[{#NAME}],3m) &lt; {$ACRONIS.CPC.CYBERFIT.HIGH}
and
max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.cyberfit[{#NAME}],3m) &lt;&gt; -1</expression>
                                    <name>Device [{#NAME}]:[{#ID}]: CyberFit score critical</name>
                                    <opdata>Current score: {ITEM.LASTVALUE}</opdata>
                                    <priority>HIGH</priority>
                                    <description>CyberFit score for this device is critical for at least 3 minutes.</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>notice</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>4c841b8207d642b28dbd365983aac0ec</uuid>
                                    <expression>min(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.cyberfit[{#NAME}],3m) &lt; {$ACRONIS.CPC.CYBERFIT.WARN}
and
max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.cyberfit[{#NAME}],3m) &lt;&gt; -1</expression>
                                    <name>Device [{#NAME}]:[{#ID}]: CyberFit score low</name>
                                    <opdata>Current score: {ITEM.LASTVALUE}</opdata>
                                    <priority>WARNING</priority>
                                    <description>CyberFit score for this device is low for at least 3 minutes.</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Device [{#NAME}]:[{#ID}]: CyberFit score critical</name>
                                            <expression>min(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.cyberfit[{#NAME}],3m) &lt; {$ACRONIS.CPC.CYBERFIT.HIGH}
and
max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.cyberfit[{#NAME}],3m) &lt;&gt; -1</expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>notice</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1f4d019c271c4272b055253d99d90244</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Next patch management run</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.patch.next[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>unixtime</units>
                            <description>Next scheduled patch management run for device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.policies.[?(@.type == &quot;policy.security.patch_management&quot;)].next_run.first()</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>return Math.floor(Date.parse(value) / 1000);</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>7f82e95335b746c1a061b0ae811165a7</uuid>
                                    <expression>last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.patch.next[{#NAME}]) &lt; (now() + {$ACRONIS.CPC.OFFSET.SCHEDULED.PATCH})</expression>
                                    <name>Device [{#NAME}]:[{#ID}]: Scheduled patch management failed to run</name>
                                    <opdata>Scheduled: {ITEM.LASTVALUE1}</opdata>
                                    <priority>WARNING</priority>
                                    <description>Scheduled patch management failed to run.</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>notice</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>8ff39ea389ec4c53aa572074266536da</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Previous successful patch management run</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.patch.prev.ok[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>unixtime</units>
                            <description>Previous successful patch management run for device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.policies.[?(@.type == &quot;policy.security.patch_management&quot;)].last_success_run.first()</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>return Math.floor(Date.parse(value) / 1000);</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>81bc4b10c3484673a76e9bb8e012af26</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Previous patch management run</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.patch.prev[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>unixtime</units>
                            <description>Previous patch management run for device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.policies.[?(@.type == &quot;policy.security.patch_management&quot;)].last_run.first()</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>return Math.floor(Date.parse(value) / 1000);</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>43dc6e6bb7e042149b356fb6b067f0d5</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Protection plan name</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.protection.name[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>Protection plan name for device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.aggregate.names</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Could not parse protection plan name</error_handler_params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>98701aa6f99f48c3a769529b2c3c3123</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Next antimalware protection scan</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.protection.scan.next[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>unixtime</units>
                            <description>Next scheduled antimalware protection scan for device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.policies.[?(@.type == &quot;policy.security.antimalware_protection&quot;)].next_run.first()</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>return Math.floor(Date.parse(value) / 1000);</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>75156ffdb1ed4b90b594e50bce8752e5</uuid>
                                    <expression>last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.protection.scan.next[{#NAME}]) &lt; (now() + {$ACRONIS.CPC.OFFSET.SCHEDULED.ANTIMALWARE})</expression>
                                    <name>Device [{#NAME}]:[{#ID}]: Scheduled antimalware scan failed to run</name>
                                    <opdata>Scheduled: {ITEM.LASTVALUE1}</opdata>
                                    <priority>WARNING</priority>
                                    <description>Scheduled antimalware scan failed to run.</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>notice</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>d9510ad24a1a40dfb14313e0e135a247</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Previous successful antimalware protection scan</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.protection.scan.prev.ok[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>unixtime</units>
                            <description>Previous successful antimalware protection scan for device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.policies.[?(@.type == &quot;policy.security.antimalware_protection&quot;)].last_success_run.first()</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>return Math.floor(Date.parse(value) / 1000);</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>684b4a46e4d84a588bd84fac3e6cfc55</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Previous antimalware protection scan</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.protection.scan.prev[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>unixtime</units>
                            <description>Previous antimalware protection scan for device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.policies.[?(@.type == &quot;policy.security.antimalware_protection&quot;)].last_run.first()</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>return Math.floor(Date.parse(value) / 1000);</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>e0a94793d31c4cf08f64c0d230134870</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Protection status</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.protection.status[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>Protection status for device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.aggregate.status</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Could not parse protection status</error_handler_params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>0c38a47343cb4df4bda534982f344c15</uuid>
                                    <expression>last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.protection.status[{#NAME}])=&quot;error&quot;</expression>
                                    <name>Device [{#NAME}]:[{#ID}]: Protection status &quot;error&quot;</name>
                                    <opdata>Current status: {ITEM.LASTVALUE}</opdata>
                                    <priority>AVERAGE</priority>
                                    <description>Device has &quot;error&quot; protection status.</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>notice</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>3338e8c43c2149819e0a48156d6ec21a</uuid>
                                    <expression>last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.protection.status[{#NAME}])=&quot;warning&quot;</expression>
                                    <name>Device [{#NAME}]:[{#ID}]: Protection status &quot;warning&quot;</name>
                                    <opdata>Current status: {ITEM.LASTVALUE}</opdata>
                                    <priority>WARNING</priority>
                                    <description>Device has &quot;warning&quot; protection status.</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Device [{#NAME}]:[{#ID}]: Protection status &quot;error&quot;</name>
                                            <expression>last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.protection.status[{#NAME}])=&quot;error&quot;</expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>notice</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>20d93972ca2f47af96aed7ee9aa642af</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Raw data resources status</name>
                            <type>HTTP_AGENT</type>
                            <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            <history>0</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>Gets statuses for device resources.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.items[0]</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_ERROR</error_handler>
                                    <error_handler_params>Could not parse resource status data</error_handler_params>
                                </step>
                            </preprocessing>
                            <timeout>15s</timeout>
                            <url>{$ACRONIS.CPC.DATACENTER.URL}{$ACRONIS.CPC.PATH.RESOURCE.MANAGEMENT}/resource_statuses</url>
                            <query_fields>
                                <query_field>
                                    <name>resource_id</name>
                                    <value>{#ID}</value>
                                </query_field>
                                <query_field>
                                    <name>include_attributes</name>
                                    <value>true</value>
                                </query_field>
                            </query_fields>
                            <status_codes/>
                            <http_proxy>{$ACRONIS.CPC.HTTP.PROXY}</http_proxy>
                            <headers>
                                <header>
                                    <name>Accept</name>
                                    <value>application/json</value>
                                </header>
                                <header>
                                    <name>Authorization</name>
                                    <value>Bearer {$ACRONIS.CPC.ACCESS_TOKEN}</value>
                                </header>
                                <header>
                                    <name>X-Application-Secret</name>
                                    <value>5619386d-de56-49ec-8508-f5c399d3b9bd</value>
                                </header>
                            </headers>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>raw</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>e6905aa1998a41cfa0e6fda699558ceb</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Next vulnerability assessment</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.vuln.next[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>unixtime</units>
                            <description>Next scheduled vulnerability assessment for device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.policies.[?(@.type == &quot;policy.security.vulnerability_assessment&quot;)].next_run.first()</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>return Math.floor(Date.parse(value) / 1000);</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>b71001b751594fc5b4b9b38673133171</uuid>
                                    <expression>last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.vuln.next[{#NAME}]) &lt; (now() + {$ACRONIS.CPC.OFFSET.SCHEDULED.VULNERABILITY})</expression>
                                    <name>Device [{#NAME}]:[{#ID}]: Scheduled vulnerability assessment failed to run</name>
                                    <opdata>Scheduled: {ITEM.LASTVALUE1}</opdata>
                                    <priority>WARNING</priority>
                                    <description>Scheduled vulnerability assessment failed to run.</description>
                                    <manual_close>YES</manual_close>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>notice</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>36fb3f57c4ae4f5cad01913a453869dc</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Previous successful vulnerability assessment</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.vuln.prev.ok[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>unixtime</units>
                            <description>Previous successful vulnerability assessment for device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.policies.[?(@.type == &quot;policy.security.vulnerability_assessment&quot;)].last_success_run.first()</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>return Math.floor(Date.parse(value) / 1000);</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>9a45c38169c848fd92b8e6a782ad065b</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: Previous vulnerability assessment</name>
                            <type>DEPENDENT</type>
                            <key>acronis.cpc.device.vuln.prev[{#NAME}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>unixtime</units>
                            <description>Previous vulnerability assessment for device.</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.policies.[?(@.type == &quot;policy.security.vulnerability_assessment&quot;)].last_run.first()</parameter>
                                    </parameters>
                                    <error_handler>DISCARD_VALUE</error_handler>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>return Math.floor(Date.parse(value) / 1000);</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>acronis.cpc.device.res.status.raw[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>application</value>
                                </tag>
                                <tag>
                                    <tag>component</tag>
                                    <value>device</value>
                                </tag>
                                <tag>
                                    <tag>resource</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>tenant</tag>
                                    <value>{#TENANT_NAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <uuid>f0a9c94a81ef4018a76b73cb98780f1f</uuid>
                            <expression>max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.backup.prev.ok[{#NAME}],1m)&lt;&gt;max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.backup.prev[{#NAME}],1m)</expression>
                            <name>Device [{#NAME}]:[{#ID}]: Previous machine backup run not successful</name>
                            <opdata>Last scan: {ITEM.LASTVALUE2}, Last OK scan: {ITEM.LASTVALUE1}</opdata>
                            <priority>AVERAGE</priority>
                            <description>Previous machine backup did not run successfully.</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>notice</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>5ce3f0bc18cd40878059b48ba436fa6d</uuid>
                            <expression>max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.patch.prev.ok[{#NAME}],1m)&lt;&gt;max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.patch.prev[{#NAME}],1m)</expression>
                            <name>Device [{#NAME}]:[{#ID}]: Previous patch management run not successful</name>
                            <opdata>Last scan: {ITEM.LASTVALUE2}, Last OK scan: {ITEM.LASTVALUE1}</opdata>
                            <priority>AVERAGE</priority>
                            <description>Previous patch management run did not run successfully.</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>notice</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>b0341da543c34c9491863a6fb8caea0c</uuid>
                            <expression>last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.protection.scan.prev.ok[{#NAME}])&lt;&gt;last(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.protection.scan.prev[{#NAME}])</expression>
                            <name>Device [{#NAME}]:[{#ID}]: Previous protection scan not successful</name>
                            <opdata>Last scan: {ITEM.LASTVALUE2}, Last OK scan: {ITEM.LASTVALUE1}</opdata>
                            <priority>AVERAGE</priority>
                            <description>Device has &quot;error&quot; protection status.</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>notice</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>3c0f47531c1a435eb93d01107a6e0b3d</uuid>
                            <expression>max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.vuln.prev.ok[{#NAME}],1m)&lt;&gt;max(/Acronis Cyber Protect Cloud MSP by HTTP/acronis.cpc.device.vuln.prev[{#NAME}],1m)</expression>
                            <name>Device [{#NAME}]:[{#ID}]: Previous vulnerability assessment not successful</name>
                            <opdata>Last scan: {ITEM.LASTVALUE2}, Last OK scan: {ITEM.LASTVALUE1}</opdata>
                            <priority>AVERAGE</priority>
                            <description>Previous vulnerability assessment did not run successfully.</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>notice</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>feba1571ed4a47d5a5bbbb16153983b0</uuid>
                            <name>Device [{#NAME}]:[{#ID}]: CyberFit score</name>
                            <graph_items>
                                <graph_item>
                                    <color>199C0D</color>
                                    <item>
                                        <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                                        <key>acronis.cpc.device.cyberfit[{#NAME}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <master_item>
                        <key>acronis.cpc.devices.get</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#ID}</lld_macro>
                            <path>$.id</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NAME}</lld_macro>
                            <path>$.name</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#TENANT_NAME}</lld_macro>
                            <path>$.tenant_name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <tags>
                <tag>
                    <tag>class</tag>
                    <value>application</value>
                </tag>
                <tag>
                    <tag>target</tag>
                    <value>acronis</value>
                </tag>
                <tag>
                    <tag>target</tag>
                    <value>cyber-protect-cloud</value>
                </tag>
            </tags>
            <macros>
                <macro>
                    <macro>{$ACRONIS.CPC.ACCESS_TOKEN}</macro>
                    <type>SECRET_TEXT</type>
                    <description>API access token.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.ALERT.DISCOVERY.CATEGORY.MATCHES}</macro>
                    <value>.*</value>
                    <description>Sets the alert category regex filter to use in alert discovery for including.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.ALERT.DISCOVERY.CATEGORY.NOT_MATCHES}</macro>
                    <value>CHANGE_IF_NEEDED</value>
                    <description>Sets the alert category regex filter to use in alert discovery for excluding.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.ALERT.DISCOVERY.RESOURCE.MATCHES}</macro>
                    <value>.*</value>
                    <description>Sets the alert resource name regex filter to use in alert discovery for including.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.ALERT.DISCOVERY.RESOURCE.NOT_MATCHES}</macro>
                    <value>CHANGE_IF_NEEDED</value>
                    <description>Sets the alert resource name regex filter to use in alert discovery for excluding.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.ALERT.DISCOVERY.SEVERITY.MATCHES}</macro>
                    <value>.*</value>
                    <description>Sets the alert severity regex filter to use in alert discovery for including.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.ALERT.DISCOVERY.SEVERITY.NOT_MATCHES}</macro>
                    <value>CHANGE_IF_NEEDED</value>
                    <description>Sets the alert severity regex filter to use in alert discovery for excluding.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.CUSTOMER.DISCOVERY.KIND.MATCHES}</macro>
                    <value>customer</value>
                    <description>Sets the customer name regex filter to use in customer discovery for including.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.CUSTOMER.DISCOVERY.NAME.MATCHES}</macro>
                    <value>.*</value>
                    <description>Sets the customer name regex filter to use in customer discovery for including.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.CUSTOMER.DISCOVERY.NAME.NOT_MATCHES}</macro>
                    <value>CHANGE_IF_NEEDED</value>
                    <description>Sets the customer name regex filter to use in customer discovery for excluding.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.CYBERFIT.HIGH}</macro>
                    <value>579</value>
                    <description>CyberFit score threshold for &quot;high&quot; severity trigger.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.CYBERFIT.WARN}</macro>
                    <value>669</value>
                    <description>CyberFit score threshold for &quot;warning&quot; severity trigger.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.DATACENTER.URL}</macro>
                    <description>Acronis Cyber Protect Cloud datacenter URL, e.g., https://eu2-cloud.acronis.com.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.DEVICE.DISCOVERY.TENANT.MATCHES}</macro>
                    <value>.*</value>
                    <description>Sets the tenant name regex filter to use in device discovery for including.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.DEVICE.DISCOVERY.TENANT.NOT_MATCHES}</macro>
                    <value>CHANGE_IF_NEEDED</value>
                    <description>Sets the tenant name regex filter to use in device discovery for excluding.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.DEVICE.RESOURCE.TYPE}</macro>
                    <value>resource.machine</value>
                    <description>Comma separated list of resource types for devices retrieval.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.HTTP.PROXY}</macro>
                    <description>Sets the HTTP proxy for the authorization item. Host prototypes will also use this value for HTTP proxy. If this parameter is empty, then no proxy is used.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.MSP.TENANT.UUID}</macro>
                    <description>UUID for MSP.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.OFFSET.SCHEDULED.ANTIMALWARE}</macro>
                    <value>-180</value>
                    <description>Offset time in seconds for scheduled antimalware scan trigger check.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.OFFSET.SCHEDULED.BACKUP}</macro>
                    <value>-180</value>
                    <description>Offset time in seconds for scheduled backup run trigger check.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.OFFSET.SCHEDULED.PATCH}</macro>
                    <value>-180</value>
                    <description>Offset time in seconds for scheduled patch management run trigger check.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.OFFSET.SCHEDULED.VULNERABILITY}</macro>
                    <value>-180</value>
                    <description>Offset time in seconds for scheduled vulnerability assessment run trigger check.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.PATH.ACCOUNT.MANAGEMENT}</macro>
                    <value>/api/2</value>
                    <description>Sub-path for the Account Management API.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.PATH.AGENTS}</macro>
                    <value>/api/agent_manager/v2</value>
                    <description>Sub-path for the Agents API.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.PATH.ALERTS}</macro>
                    <value>/api/alert_manager/v1</value>
                    <description>Sub-path for the Alerts API.</description>
                </macro>
                <macro>
                    <macro>{$ACRONIS.CPC.PATH.RESOURCE.MANAGEMENT}</macro>
                    <value>/api/resource_management/v4</value>
                    <description>Sub-path for the Resource Management API.</description>
                </macro>
            </macros>
            <dashboards>
                <dashboard>
                    <uuid>711853342bbe4a5b8d145fc96644d1e5</uuid>
                    <name>Acronis Cyber Protect Cloud Overview</name>
                    <pages>
                        <page>
                            <widgets>
                                <widget>
                                    <type>ITEM</type>
                                    <width>3</width>
                                    <height>3</height>
                                    <hide_header>YES</hide_header>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>adv_conf</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>bg_color</name>
                                            <value>1EA7FD</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>decimal_places</name>
                                            <value>0</value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>description</name>
                                            <value>&quot;Information&quot; severity alert count</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>desc_size</name>
                                            <value>8</value>
                                        </field>
                                        <field>
                                            <type>ITEM</type>
                                            <name>itemid</name>
                                            <value>
                                                <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                                                <key>acronis.cpc.alerts.severity.info</key>
                                            </value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>show</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>show</name>
                                            <value>2</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>ITEM</type>
                                    <y>3</y>
                                    <width>3</width>
                                    <height>3</height>
                                    <hide_header>YES</hide_header>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>adv_conf</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>bg_color</name>
                                            <value>66BF3C</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>decimal_places</name>
                                            <value>0</value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>description</name>
                                            <value>&quot;OK&quot; severity alert count</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>desc_size</name>
                                            <value>8</value>
                                        </field>
                                        <field>
                                            <type>ITEM</type>
                                            <name>itemid</name>
                                            <value>
                                                <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                                                <key>acronis.cpc.alerts.severity.ok</key>
                                            </value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>show</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>show</name>
                                            <value>2</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>ITEM</type>
                                    <y>6</y>
                                    <width>3</width>
                                    <height>3</height>
                                    <hide_header>YES</hide_header>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>adv_conf</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>bg_color</name>
                                            <value>E69D00</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>decimal_places</name>
                                            <value>0</value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>description</name>
                                            <value>&quot;Warning&quot; severity alert count</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>desc_size</name>
                                            <value>8</value>
                                        </field>
                                        <field>
                                            <type>ITEM</type>
                                            <name>itemid</name>
                                            <value>
                                                <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                                                <key>acronis.cpc.alerts.severity.warn</key>
                                            </value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>show</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>show</name>
                                            <value>2</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>ITEM</type>
                                    <y>9</y>
                                    <width>3</width>
                                    <height>3</height>
                                    <hide_header>YES</hide_header>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>adv_conf</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>bg_color</name>
                                            <value>FF4400</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>decimal_places</name>
                                            <value>0</value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>description</name>
                                            <value>&quot;Error&quot; severity alert count</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>desc_size</name>
                                            <value>8</value>
                                        </field>
                                        <field>
                                            <type>ITEM</type>
                                            <name>itemid</name>
                                            <value>
                                                <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                                                <key>acronis.cpc.alerts.severity.err</key>
                                            </value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>show</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>show</name>
                                            <value>2</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>ITEM</type>
                                    <y>12</y>
                                    <width>3</width>
                                    <height>3</height>
                                    <hide_header>YES</hide_header>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>adv_conf</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>bg_color</name>
                                            <value>E23636</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>decimal_places</name>
                                            <value>0</value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>description</name>
                                            <value>&quot;Critical&quot; severity alert count</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>desc_size</name>
                                            <value>8</value>
                                        </field>
                                        <field>
                                            <type>ITEM</type>
                                            <name>itemid</name>
                                            <value>
                                                <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                                                <key>acronis.cpc.alerts.severity.crit</key>
                                            </value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>show</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>show</name>
                                            <value>2</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_CLASSIC</type>
                                    <x>3</x>
                                    <width>4</width>
                                    <height>6</height>
                                    <fields>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid</name>
                                            <value>
                                                <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                                                <name>Acronis CPC: Alerts overview</name>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_PROTOTYPE</type>
                                    <x>3</x>
                                    <y>6</y>
                                    <width>12</width>
                                    <height>9</height>
                                    <fields>
                                        <field>
                                            <type>GRAPH_PROTOTYPE</type>
                                            <name>graphid</name>
                                            <value>
                                                <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                                                <name>Device [{#NAME}]:[{#ID}]: CyberFit score</name>
                                            </value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>rows</name>
                                            <value>2</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_PROTOTYPE</type>
                                    <x>7</x>
                                    <width>8</width>
                                    <height>6</height>
                                    <fields>
                                        <field>
                                            <type>ITEM_PROTOTYPE</type>
                                            <name>itemid</name>
                                            <value>
                                                <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                                                <key>acronis.cpc.customer.status[{#NAME}]</key>
                                            </value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>source_type</name>
                                            <value>3</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_PROTOTYPE</type>
                                    <x>15</x>
                                    <width>9</width>
                                    <height>7</height>
                                    <fields>
                                        <field>
                                            <type>ITEM_PROTOTYPE</type>
                                            <name>itemid</name>
                                            <value>
                                                <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                                                <key>acronis.cpc.device.agent.enabled[{#NAME}]</key>
                                            </value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>source_type</name>
                                            <value>3</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_PROTOTYPE</type>
                                    <x>15</x>
                                    <y>7</y>
                                    <width>9</width>
                                    <height>8</height>
                                    <fields>
                                        <field>
                                            <type>ITEM_PROTOTYPE</type>
                                            <name>itemid</name>
                                            <value>
                                                <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                                                <key>acronis.cpc.device.agent.online[{#NAME}]</key>
                                            </value>
                                        </field>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>source_type</name>
                                            <value>3</value>
                                        </field>
                                    </fields>
                                </widget>
                            </widgets>
                        </page>
                    </pages>
                </dashboard>
            </dashboards>
            <valuemaps>
                <valuemap>
                    <uuid>0c425866d0ce4412a54b66f215df4cde</uuid>
                    <name>Alert severity</name>
                    <mappings>
                        <mapping>
                            <value>0</value>
                            <newvalue>OK</newvalue>
                        </mapping>
                        <mapping>
                            <value>1</value>
                            <newvalue>Warning</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>Error</newvalue>
                        </mapping>
                        <mapping>
                            <value>3</value>
                            <newvalue>Critical</newvalue>
                        </mapping>
                        <mapping>
                            <value>4</value>
                            <newvalue>Information</newvalue>
                        </mapping>
                        <mapping>
                            <value>10</value>
                            <newvalue>Unknown</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>4a5652b3706a45faa2b86ae652425692</uuid>
                    <name>CyberFit score</name>
                    <mappings>
                        <mapping>
                            <value>-1</value>
                            <newvalue>Unavailable</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>df45c606a7ef4f49a3101ad135eef1bc</uuid>
                    <name>True false</name>
                    <mappings>
                        <mapping>
                            <value>0</value>
                            <newvalue>False</newvalue>
                        </mapping>
                        <mapping>
                            <value>1</value>
                            <newvalue>True</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
            </valuemaps>
        </template>
        <template>
            <uuid>7e6bb0931a72459db9514aa924b420bc</uuid>
            <template>AIX by Zabbix agent</template>
            <name>AIX by Zabbix agent</name>
            <description>It is an official AIX template. It requires Zabbix agent 6.0 or newer.

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/

Generated by official Zabbix template tool &quot;Templator&quot;</description>
            <groups>
                <group>
                    <name>Templates/Operating systems</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>4c80c15f5741464882aa238f27bec1bd</uuid>
                    <name>AIX: Host name of Zabbix agent running</name>
                    <key>agent.hostname</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>05849e0fb6504d339f2aebe159427bec</uuid>
                    <name>AIX: Zabbix agent ping</name>
                    <key>agent.ping</key>
                    <history>7d</history>
                    <description>The agent always returns 1 for this item. It could be used in combination with nodata() for the availability check.</description>
                    <valuemap>
                        <name>Zabbix agent ping status</name>
                    </valuemap>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>fe4731720ba64eebbf125929e499209b</uuid>
                    <name>AIX: Version of Zabbix agent running</name>
                    <key>agent.version</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>application</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2c2d08ab5833493ba45ebfe5154f04c1</uuid>
                    <name>AIX: Number of running processes</name>
                    <key>proc.num[,,run]</key>
                    <history>7d</history>
                    <description>The number of processes in a running state.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>os</value>
                        </tag>
                        <tag>
                            <tag>component</tag>
                            <value>processes</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>458180bc0f14468386429964f877cce7</uuid>
                            <expression>avg(/AIX by Zabbix agent/proc.num[,,run],5m)&gt;30</expression>
                            <name>AIX: Too many processes running</name>
                            <priority>WARNING</priority>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>performance</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>7c64480f840a4778bde5278e1c0a083f</uuid>
                    <name>AIX: Number of processes</name>
                    <key>proc.num[]</key>
                    <history>7d</history>
                    <description>The total number of processes in any state.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>os</value>
                        </tag>
                        <tag>
                            <tag>component</tag>
                            <value>processes</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>874ef8fe4a6445ff971800d2d9a50541</uuid>
                            <expression>avg(/AIX by Zabbix agent/proc.num[],5m)&gt;300</expression>
                            <name>AIX: Too many processes</name>
                            <priority>WARNING</priority>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>performance</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>4a15778222a24f129b8ae7c240a32ded</uuid>
                    <name>AIX: Interrupts per second</name>
                    <key>system.cpu.intr</key>
                    <history>7d</history>
                    <units>ips</units>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>4f8665f48aff4fa39e85639fed7b71c5</uuid>
                    <name>AIX: Processor load (1 min average per core)</name>
                    <key>system.cpu.load[percpu,avg1]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <description>The processor load is calculated as the system CPU load divided by the number of CPU cores.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>fdbedf15fe474fd18c045c62cf8cc7d6</uuid>
                            <expression>avg(/AIX by Zabbix agent/system.cpu.load[percpu,avg1],5m)&gt;5</expression>
                            <name>AIX: Processor load is too high</name>
                            <priority>WARNING</priority>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>performance</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>6fa2275f1f83456abfe786c8565c7a2d</uuid>
                    <name>AIX: Processor load (5 min average per core)</name>
                    <key>system.cpu.load[percpu,avg5]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <description>The processor load is calculated as the system CPU load divided by the number of CPU cores.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>02210ac2faaa4f7bb74e995726706abc</uuid>
                    <name>AIX: Processor load (15 min average per core)</name>
                    <key>system.cpu.load[percpu,avg15]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <description>The processor load is calculated as the system CPU load divided by the number of CPU cores.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1ad486947da9428abdebcecb83ca3d8b</uuid>
                    <name>AIX: Context switches per second</name>
                    <key>system.cpu.switches</key>
                    <history>7d</history>
                    <units>sps</units>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f4d10d49fa3c4dababf03d2cb80f044c</uuid>
                    <name>AIX: Host name</name>
                    <key>system.hostname</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>A host name of the system.</description>
                    <inventory_link>NAME</inventory_link>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>os</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>d1e70b7f465447a3ab575b3fd28755a1</uuid>
                            <expression>last(/AIX by Zabbix agent/system.hostname,#1)&lt;&gt;last(/AIX by Zabbix agent/system.hostname,#2)</expression>
                            <name>AIX: Hostname was changed</name>
                            <priority>INFO</priority>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>notice</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>aebc5bb0264a4f55985c96445964dfc4</uuid>
                    <name>AIX: Host local time</name>
                    <key>system.localtime</key>
                    <history>7d</history>
                    <units>unixtime</units>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>os</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>081f8986446d43e7a3b72f7084576600</uuid>
                    <name>AIX: CPU available physical processors in the shared pool</name>
                    <key>system.stat[cpu,app]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>6a97d56a6c2e45e1b10b97e2395ff30d</uuid>
                    <name>AIX: CPU entitled capacity consumed</name>
                    <key>system.stat[cpu,ec]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>142f33d7b2c3469c9664fedf4f053616</uuid>
                    <name>AIX: CPU idle time</name>
                    <key>system.stat[cpu,id]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>752c952fb18e4a0e8e5e3415b107b9f1</uuid>
                    <name>AIX: CPU logical processor utilization</name>
                    <key>system.stat[cpu,lbusy]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>748f1316a33b48658b11dca8f45cfcce</uuid>
                    <name>AIX: CPU number of physical processors consumed</name>
                    <key>system.stat[cpu,pc]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2647132edb6647ca9ef43a00ca09ecbd</uuid>
                    <name>AIX: CPU system time</name>
                    <key>system.stat[cpu,sy]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e990898ddbb74c7b9a8c1c67cb9544cf</uuid>
                    <name>AIX: CPU user time</name>
                    <key>system.stat[cpu,us]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2cd7a00570ad487d9cdf39fd198b2c0b</uuid>
                    <name>AIX: CPU iowait time</name>
                    <key>system.stat[cpu,wa]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>c030cc99975d4fe3911789e58bbd5050</uuid>
                            <expression>avg(/AIX by Zabbix agent/system.stat[cpu,wa],5m)&gt;20</expression>
                            <name>AIX: Disk I/O is overloaded</name>
                            <priority>WARNING</priority>
                            <description>The OS spends significant time waiting for the I/O (input/output) operations. It could be an indicator of performance issues with the storage system.</description>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>performance</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>6748e4c87589472ca1474f3c7b729e0c</uuid>
                    <name>AIX: Amount of data transferred</name>
                    <key>system.stat[disk,bps]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>B</units>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>storage</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>bf0180d8f109451db616749990a113a6</uuid>
                    <name>AIX: Number of transfers</name>
                    <key>system.stat[disk,tps]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>storage</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3e1af0261f6a421d8ca554f8eb222716</uuid>
                    <name>AIX: Processor units is entitled to receive</name>
                    <key>system.stat[ent]</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>0fe71698a3c74c93a8cb3a937dc7226c</uuid>
                    <name>AIX: Kernel thread context switches</name>
                    <key>system.stat[faults,cs]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a1e13d2dbd8b4086974ea32a2cd743b1</uuid>
                    <name>AIX: Device interrupts</name>
                    <key>system.stat[faults,in]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>883c7a12b1d54f4d8189ca0d9cc43102</uuid>
                    <name>AIX: System calls</name>
                    <key>system.stat[faults,sy]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f027ed1c43464d4ab9a13d4b9f647e7e</uuid>
                    <name>AIX: Length of the swap queue</name>
                    <key>system.stat[kthr,b]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>6795c2b6914d4303bf30c71c7405ff7d</uuid>
                    <name>AIX: Length of the run queue</name>
                    <key>system.stat[kthr,r]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>cpu</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>12142f133863448c9c937c671e183bbb</uuid>
                    <name>AIX: Active virtual pages</name>
                    <key>system.stat[memory,avm]</key>
                    <history>7d</history>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3b4a5ff768654ff5a87b955684a0d7b5</uuid>
                    <name>AIX: Free real memory</name>
                    <key>system.stat[memory,fre]</key>
                    <history>7d</history>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>bf890bf5cd1748a5af9528a111ba43c4</uuid>
                    <name>AIX: File page-ins per second</name>
                    <key>system.stat[page,fi]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>19c4f7132b6c46aa9522bd46da3e8f03</uuid>
                    <name>AIX: File page-outs per second</name>
                    <key>system.stat[page,fo]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>9ff3f7faa76c414aae7c5babb91fe065</uuid>
                    <name>AIX: Pages freed (page replacement)</name>
                    <key>system.stat[page,fr]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>6009d8a0fc2f486db979b226eb975e78</uuid>
                    <name>AIX: Pages paged in from paging space</name>
                    <key>system.stat[page,pi]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>26fb1471e08c4c46800e4887d8bccd80</uuid>
                    <name>AIX: Pages paged out to paging space</name>
                    <key>system.stat[page,po]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>83b1456726d448d6a756e03c0ec02342</uuid>
                    <name>AIX: Pages scanned by page-replacement algorithm</name>
                    <key>system.stat[page,sr]</key>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d0ef675d313849269890d06c7e003c9e</uuid>
                    <name>AIX: System information</name>
                    <key>system.uname</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>The information as normally returned by the 'uname -a'.</description>
                    <inventory_link>OS</inventory_link>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>os</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>3a736e64211744aea480a60b2c48a036</uuid>
                            <expression>last(/AIX by Zabbix agent/system.uname,#1)&lt;&gt;last(/AIX by Zabbix agent/system.uname,#2)</expression>
                            <name>AIX: Host information was changed</name>
                            <priority>INFO</priority>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>notice</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>2e0ff86c992c4a098af8cb1bee0f0001</uuid>
                    <name>AIX: System uptime</name>
                    <key>system.uptime</key>
                    <delay>10m</delay>
                    <history>7d</history>
                    <units>uptime</units>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>os</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>03a2cd88b6a64d3ea4c9bb2abbc4ae2d</uuid>
                            <expression>change(/AIX by Zabbix agent/system.uptime)&lt;0</expression>
                            <name>AIX: Server has just been restarted</name>
                            <priority>INFO</priority>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>notice</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>980a59760ef9481298ed35322841f939</uuid>
                    <name>AIX: Number of logged in users</name>
                    <key>system.users.num</key>
                    <history>7d</history>
                    <description>The number of users who are currently logged in.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>os</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>4771d6d33c2247d6843198152a7065a8</uuid>
                    <name>AIX: Checksum of /etc/passwd</name>
                    <key>vfs.file.cksum[/etc/passwd,sha256]</key>
                    <delay>15m</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>security</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>c75ee957fd6c43b2aba9919d5e1af4a1</uuid>
                            <expression>last(/AIX by Zabbix agent/vfs.file.cksum[/etc/passwd,sha256],#1)&lt;&gt;last(/AIX by Zabbix agent/vfs.file.cksum[/etc/passwd,sha256],#2)</expression>
                            <name>AIX: /etc/passwd has been changed</name>
                            <priority>WARNING</priority>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>security</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>6d4d9deab17b42f4a953c5210acac6f1</uuid>
                    <name>AIX: Available memory</name>
                    <key>vm.memory.size[available]</key>
                    <history>7d</history>
                    <units>B</units>
                    <description>The available memory is defined as free+cached+buffers memory.</description>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>80b6406fb8474fa9801e9dffb2ccd368</uuid>
                            <expression>last(/AIX by Zabbix agent/vm.memory.size[available])&lt;20M</expression>
                            <name>AIX: Lack of available memory on server</name>
                            <priority>AVERAGE</priority>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>capacity</value>
                                </tag>
                                <tag>
                                    <tag>scope</tag>
                                    <value>performance</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>57d30ccd5db64dc8b9498a36efe768e9</uuid>
                    <name>AIX: Total memory</name>
                    <key>vm.memory.size[total]</key>
                    <delay>1h</delay>
                    <history>7d</history>
                    <units>B</units>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>memory</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>304a3e9bb7594c83b027a32c34aeab28</uuid>
                    <name>AIX: Zabbix agent availability</name>
                    <type>INTERNAL</type>
                    <key>zabbix[host,agent,available]</key>
                    <history>7d</history>
                    <description>Monitoring the availability status of the agent.</description>
                    <valuemap>
                        <name>zabbix.host.available</name>
                    </valuemap>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>system</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>f0b9ecafede8476b94fd8dcab74cea87</uuid>
                            <expression>max(/AIX by Zabbix agent/zabbix[host,agent,available],{$AGENT.TIMEOUT})=0</expression>
                            <name>AIX: Zabbix agent is not available</name>
                            <event_name>Zabbix agent is not available (for {$AGENT.TIMEOUT})</event_name>
                            <priority>AVERAGE</priority>
                            <description>For passive checks only the availability of the agent(s) and a host is used with {$AGENT.TIMEOUT} as the time threshold.</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>availability</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>409cce8967b4494bbcc5193a26c69b06</uuid>
                    <name>Network interface discovery</name>
                    <key>net.if.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>@Network interfaces for discovery</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>The discovery of network interfaces as defined in the global regular expression &quot;Network interfaces for discovery&quot;.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>df9710a48eaa4a72911de3971b37c596</uuid>
                            <name>Interface {#IFNAME}: Incoming network traffic</name>
                            <key>net.if.in[{#IFNAME}]</key>
                            <history>7d</history>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>network</value>
                                </tag>
                                <tag>
                                    <tag>interface</tag>
                                    <value>{#IFNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>0704fb302aa94f73bedade3a998a0fa3</uuid>
                            <name>Interface {#IFNAME}: Outgoing network traffic</name>
                            <key>net.if.out[{#IFNAME}]</key>
                            <history>7d</history>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>network</value>
                                </tag>
                                <tag>
                                    <tag>interface</tag>
                                    <value>{#IFNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>366a988491344fd487561d02ed499fe0</uuid>
                            <name>Interface {#IFNAME}: Network traffic</name>
                            <graph_items>
                                <graph_item>
                                    <color>199C0D</color>
                                    <item>
                                        <host>AIX by Zabbix agent</host>
                                        <key>net.if.in[{#IFNAME}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>AIX by Zabbix agent</host>
                                        <key>net.if.out[{#IFNAME}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <uuid>4a0b17decdf1449d9463cf00720a843d</uuid>
                    <name>Mounted filesystem discovery</name>
                    <key>vfs.fs.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#FSTYPE}</macro>
                                <value>@File systems for discovery</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>The discovery of different types of file systems as defined in the global regular expression &quot;File systems for discovery&quot;.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>ee5ae5de6f7b40b4a9b064bdc733de91</uuid>
                            <name>{#FSNAME}: Free inodes, %</name>
                            <key>vfs.fs.inode[{#FSNAME},pfree]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>filesystem</value>
                                </tag>
                                <tag>
                                    <tag>filesystem</tag>
                                    <value>{#FSNAME}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>6ce467d05e8745409a177799bed34bb3</uuid>
                                    <expression>last(/AIX by Zabbix agent/vfs.fs.inode[{#FSNAME},pfree])&lt;20</expression>
                                    <name>{#FSNAME}: Free inodes is less than 20%</name>
                                    <priority>WARNING</priority>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>capacity</value>
                                        </tag>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>performance</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>13e212598f744a7fa535c23731190c61</uuid>
                            <name>{#FSNAME}: Free disk space</name>
                            <key>vfs.fs.size[{#FSNAME},free]</key>
                            <history>7d</history>
                            <units>B</units>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>filesystem</value>
                                </tag>
                                <tag>
                                    <tag>filesystem</tag>
                                    <value>{#FSNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>428b0314dd574df1970dd2cae7e8889b</uuid>
                            <name>{#FSNAME}: Free disk space, %</name>
                            <key>vfs.fs.size[{#FSNAME},pfree]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>filesystem</value>
                                </tag>
                                <tag>
                                    <tag>filesystem</tag>
                                    <value>{#FSNAME}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>74a1fc62bfe24b7eabe4e244c70dc384</uuid>
                                    <expression>last(/AIX by Zabbix agent/vfs.fs.size[{#FSNAME},pfree])&lt;20</expression>
                                    <name>{#FSNAME}: Free disk space is less than 20%</name>
                                    <priority>WARNING</priority>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>capacity</value>
                                        </tag>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>performance</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>6f6c92bc72014612b2efb92d12d8c425</uuid>
                            <name>{#FSNAME}: Total disk space</name>
                            <key>vfs.fs.size[{#FSNAME},total]</key>
                            <delay>1h</delay>
                            <history>7d</history>
                            <units>B</units>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>filesystem</value>
                                </tag>
                                <tag>
                                    <tag>filesystem</tag>
                                    <value>{#FSNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>915e72271f134684b2d10d05d4035962</uuid>
                            <name>{#FSNAME}: Used disk space</name>
                            <key>vfs.fs.size[{#FSNAME},used]</key>
                            <history>7d</history>
                            <units>B</units>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>filesystem</value>
                                </tag>
                                <tag>
                                    <tag>filesystem</tag>
                                    <value>{#FSNAME}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>460b553fcd924b6abbde0b00a5525445</uuid>
                            <name>{#FSNAME}: Disk space usage</name>
                            <graph_items>
                                <graph_item>
                                    <color>199C0D</color>
                                    <item>
                                        <host>AIX by Zabbix agent</host>
                                        <key>vfs.fs.size[{#FSNAME},total]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>AIX by Zabbix agent</host>
                                        <key>vfs.fs.size[{#FSNAME},free]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <overrides>
                        <override>
                            <name>Skip metadata collection for dynamic FS</name>
                            <step>1</step>
                            <filter>
                                <conditions>
                                    <condition>
                                        <macro>{#FSTYPE}</macro>
                                        <value>^(btrfs|zfs)$</value>
                                        <formulaid>A</formulaid>
                                    </condition>
                                </conditions>
                            </filter>
                            <operations>
                                <operation>
                                    <operationobject>ITEM_PROTOTYPE</operationobject>
                                    <operator>LIKE</operator>
                                    <value>inode</value>
                                    <discover>NO_DISCOVER</discover>
                                </operation>
                            </operations>
                        </override>
                    </overrides>
                </discovery_rule>
            </discovery_rules>
            <tags>
                <tag>
                    <tag>class</tag>
                    <value>os</value>
                </tag>
                <tag>
                    <tag>target</tag>
                    <value>aix</value>
                </tag>
            </tags>
            <macros>
                <macro>
                    <macro>{$AGENT.TIMEOUT}</macro>
                    <value>3m</value>
                    <description>The timeout after which agent is considered unavailable. It works only for the agents reachable from Zabbix server/proxy (in passive mode).</description>
                </macro>
            </macros>
            <dashboards>
                <dashboard>
                    <uuid>873e38e16ef94f2b9b743a3251db0fbb</uuid>
                    <name>System performance</name>
                    <pages>
                        <page>
                            <widgets>
                                <widget>
                                    <type>GRAPH_CLASSIC</type>
                                    <width>12</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid</name>
                                            <value>
                                                <host>AIX by Zabbix agent</host>
                                                <name>AIX: CPU load</name>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_CLASSIC</type>
                                    <y>5</y>
                                    <width>12</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid</name>
                                            <value>
                                                <host>AIX by Zabbix agent</host>
                                                <name>AIX: CPU utilization</name>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_CLASSIC</type>
                                    <x>12</x>
                                    <width>12</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid</name>
                                            <value>
                                                <host>AIX by Zabbix agent</host>
                                                <name>AIX: CPU jumps</name>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_CLASSIC</type>
                                    <x>12</x>
                                    <y>5</y>
                                    <width>12</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid</name>
                                            <value>
                                                <host>AIX by Zabbix agent</host>
                                                <name>AIX: Memory usage</name>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                            </widgets>
                        </page>
                    </pages>
                </dashboard>
            </dashboards>
            <valuemaps>
                <valuemap>
                    <uuid>4a25a6b3d6e4482ab2a748c79cb55524</uuid>
                    <name>zabbix.host.available</name>
                    <mappings>
                        <mapping>
                            <value>0</value>
                            <newvalue>not available</newvalue>
                        </mapping>
                        <mapping>
                            <value>1</value>
                            <newvalue>available</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>unknown</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>f2885fb5e52946f8bce8eb96a60f433a</uuid>
                    <name>Zabbix agent ping status</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>Up</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
            </valuemaps>
        </template>
    </templates>
    <graphs>
        <graph>
            <uuid>1950de4a315f487f9382d82c2dba1778</uuid>
            <name>Acronis CPC: Alerts overview</name>
            <type>PIE</type>
            <graph_items>
                <graph_item>
                    <color>1EA7FD</color>
                    <item>
                        <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                        <key>acronis.cpc.alerts.severity.info</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>66BF3C</color>
                    <item>
                        <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                        <key>acronis.cpc.alerts.severity.ok</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>E69D00</color>
                    <item>
                        <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                        <key>acronis.cpc.alerts.severity.warn</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>FF4400</color>
                    <item>
                        <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                        <key>acronis.cpc.alerts.severity.err</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>4</sortorder>
                    <color>E8083E</color>
                    <item>
                        <host>Acronis Cyber Protect Cloud MSP by HTTP</host>
                        <key>acronis.cpc.alerts.severity.crit</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>a3a5bc3b07f34793bb1c8cfc688ba8a9</uuid>
            <name>AIX: CPU jumps</name>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <item>
                        <host>AIX by Zabbix agent</host>
                        <key>system.cpu.switches</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>AIX by Zabbix agent</host>
                        <key>system.cpu.intr</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>260417d4613d405986406c272f54a5aa</uuid>
            <name>AIX: CPU load</name>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <item>
                        <host>AIX by Zabbix agent</host>
                        <key>system.cpu.load[percpu,avg1]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>AIX by Zabbix agent</host>
                        <key>system.cpu.load[percpu,avg5]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>00611C</color>
                    <item>
                        <host>AIX by Zabbix agent</host>
                        <key>system.cpu.load[percpu,avg15]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>a2eeb8269edf4de7ac13b7ceb1260b75</uuid>
            <name>AIX: CPU utilization</name>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <item>
                        <host>AIX by Zabbix agent</host>
                        <key>system.stat[cpu,ec]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>AIX by Zabbix agent</host>
                        <key>system.stat[cpu,pc]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>00611C</color>
                    <item>
                        <host>AIX by Zabbix agent</host>
                        <key>system.stat[cpu,wa]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>F7941D</color>
                    <item>
                        <host>AIX by Zabbix agent</host>
                        <key>system.stat[cpu,sy]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>4</sortorder>
                    <color>FC6EA3</color>
                    <item>
                        <host>AIX by Zabbix agent</host>
                        <key>system.stat[cpu,us]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>5</sortorder>
                    <color>6C59DC</color>
                    <item>
                        <host>AIX by Zabbix agent</host>
                        <key>system.stat[cpu,id]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>2664343cd69444e0a16850083845838f</uuid>
            <name>AIX: Memory usage</name>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <item>
                        <host>AIX by Zabbix agent</host>
                        <key>vm.memory.size[available]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
</zabbix_export>
